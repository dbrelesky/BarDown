---
phase: 03-scoreboard
plan: 02
type: tdd
wave: 1
depends_on: []
files_modified:
  - BarDown-iOS/BarDownTests/GameModelTests.swift
  - BarDown-iOS/BarDownTests/ScoreboardViewModelTests.swift
  - BarDown-iOS/BarDownTests/DateStripTests.swift
  - BarDown-iOS/BarDownTests/Fixtures/games-response.json
autonomous: true
requirements: [SCOR-01, SCOR-02, SCOR-03, SCOR-06, SCOR-07]

must_haves:
  truths:
    - "GameModelTests.swift exists with failing tests for JSON decode of GameModel and TeamModel"
    - "ScoreboardViewModelTests.swift exists with failing tests for state machine transitions and refresh"
    - "DateStripTests.swift exists with failing tests for date filtering and selection"
    - "games-response.json fixture exists with one live, one scheduled, one final game"
    - "All new test targets compile but intentionally fail (RED phase)"
  artifacts:
    - path: "BarDown-iOS/BarDownTests/GameModelTests.swift"
      provides: "Unit tests for GameModel/TeamModel JSON decode"
      exports: ["GameModelTests"]
    - path: "BarDown-iOS/BarDownTests/ScoreboardViewModelTests.swift"
      provides: "Unit tests for ViewModel state machine"
      exports: ["ScoreboardViewModelTests"]
    - path: "BarDown-iOS/BarDownTests/DateStripTests.swift"
      provides: "Unit tests for date filtering logic"
      exports: ["DateStripTests"]
    - path: "BarDown-iOS/BarDownTests/Fixtures/games-response.json"
      provides: "Sample JSON fixture for decode tests"
  key_links:
    - from: "BarDown-iOS/BarDownTests/GameModelTests.swift"
      to: "BarDown-iOS/BarDownTests/Fixtures/games-response.json"
      via: "Bundle.module fixture loading"
      pattern: "games-response\\.json"
---

<objective>
Create the Wave 0 test scaffolds required by the Nyquist Rule before any implementation begins. These are the RED phase of TDD — tests that describe required behavior but fail because the implementation types do not yet exist.

Purpose: Defines the contract that implementation plans 03-03 through 03-06 must satisfy. Tests drive design.

Output: Three test files + one JSON fixture. All tests compile but fail (or skip) because `GameModel`, `ScoreboardViewModel`, and `DateStripViewModel` types are not yet defined.
</objective>

<execution_context>
@/Users/darrenbrelesky/.claude/get-shit-done/workflows/execute-plan.md
@/Users/darrenbrelesky/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-scoreboard/03-RESEARCH.md

@BarDown-iOS/BarDownTests/GlassAuditTests.swift
@BarDown-iOS/project.yml
@Sources/App/DTOs/GameResponse.swift
@Sources/App/DTOs/TeamBrief.swift
</context>

<feature>
  <name>Wave 0: Test scaffolds for scoreboard models, ViewModel, and date strip</name>
  <files>
    BarDown-iOS/BarDownTests/Fixtures/games-response.json,
    BarDown-iOS/BarDownTests/GameModelTests.swift,
    BarDown-iOS/BarDownTests/ScoreboardViewModelTests.swift,
    BarDown-iOS/BarDownTests/DateStripTests.swift
  </files>
  <behavior>
    GameModelTests:
    - JSON from games-response.json decodes into [GameModel] without throwing
    - Decoded array contains 3 games (live, scheduled, final)
    - Live game: status == "live", homeScore and awayScore are Int, period and clock non-nil
    - Scheduled game: status == "scheduled", startTime in future
    - Final game: status == "final", isFinal == true
    - TeamModel fields present: id, name, abbreviation, conference, record, ranking (optional)
    - GameModel.gameStatus sorts correctly: live(0) < scheduled(1) < final(2)

    ScoreboardViewModelTests:
    - Initial state is .loading
    - After loadGames with empty array: state transitions to .empty
    - After loadGames with 3 games: state transitions to .loaded([GameModel])
    - After loadGames throws error: state transitions to .error(String)
    - refresh() sets isRefreshing = true then false after completion
    - selectedDate defaults to today's start of day (Eastern)

    DateStripTests:
    - Given gameDates = ["2026-03-01", "2026-03-03", "2026-03-05"]
    - DateStrip only displays those 3 dates (not every calendar day in range)
    - Selecting "2026-03-03" sets selectedDate to that date in ViewModel
    - Date string formatter uses America/New_York timezone
  </behavior>
  <implementation>
    Create the Fixtures/ subdirectory. Write games-response.json with three game objects matching the GameResponse DTO shape (id, homeTeam, awayTeam, homeScore, awayScore, status, period, clock, startTime as ISO8601 string, quarterScores array).

    Write test files using Swift Testing framework (`import Testing`), matching the pattern in GlassAuditTests.swift. Tests MUST reference types from the BarDown app target (GameModel, ScoreboardViewModel) — these don't exist yet, so tests will fail to compile. Use `withKnownIssue` or structure tests so they express intent clearly even if the type is missing.

    IMPORTANT: Since GameModel and ScoreboardViewModel do not exist yet, the test files WILL NOT COMPILE in the RED phase. This is expected and correct. Write them as if the types exist — the compile errors ARE the failing tests. The executor (Plan 03-03) will make them compile by creating the types.

    Use `@Suite` and `@Test` attributes. Match the style of GlassAuditTests.swift. Use `import Testing` and `import Foundation`.

    For fixture loading in GameModelTests, load the JSON from Bundle:
    ```swift
    let url = Bundle(for: GameModelTests.self).url(forResource: "games-response", withExtension: "json")!
    let data = try Data(contentsOf: url)
    let games = try JSONDecoder().decode([GameModel].self, from: data)
    ```

    Ensure project.yml includes BarDownTests sources so the Fixtures/ subdirectory is picked up (it already uses `path: BarDownTests` which is recursive).
  </implementation>
</feature>

<verification>
- `xcodebuild build -project BarDown-iOS/BarDown.xcodeproj -scheme BarDown -destination 'platform=iOS Simulator,name=iPhone 17 Pro' 2>&1 | tail -5` — app target builds clean (tests may fail to compile; that is correct in RED phase)
- Three test files exist at expected paths
- Fixture JSON at BarDown-iOS/BarDownTests/Fixtures/games-response.json parses as valid JSON
- Test files reference GameModel, TeamModel, ScoreboardViewModel (names that will be created in 03-03 and 03-04)
</verification>

<success_criteria>
All four files exist. games-response.json is valid JSON with three game objects (live, scheduled, final). Test files use Swift Testing syntax and reference types that will be created in subsequent plans. App target (BarDown) builds clean. Test target compile failures are expected and acceptable — they constitute the RED phase.
</success_criteria>

<output>
After completion, create `.planning/phases/03-scoreboard/03-02-SUMMARY.md`
</output>
